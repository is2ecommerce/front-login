<!-- user-profile.component.html -->
<div class="user-profile-container">
  <!-- HEADER CON GRADIENTE -->
  <div class="profile-header">
    <div class="header-gradient"></div>
    <div class="header-content" *ngIf="usuario; else cargando">
      <div class="profile-avatar-section">
        <img [src]="usuario.imagen" alt="Foto de perfil" class="profile-avatar" />
        <div class="profile-name-section">
          <h1>{{ usuario.nombre }}</h1>
          <p class="profile-email">{{ usuario.email }}</p>
          <p class="profile-member">Miembro desde {{ usuario.miembroDesde | date:'MMMM yyyy' }}</p>
        </div>
      </div>
      <button class="btn-primary" (click)="editarPerfil()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
          <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
        </svg>
        Editar perfil
      </button>
      <button class="btn-logout" (click)="cerrarSesion()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        Cerrar sesión
      </button>
    </div>
  </div>

  <!-- CONTENIDO PRINCIPAL -->
  <div class="profile-content" *ngIf="usuario; else cargando">
    <!-- SECCIÓN DE INFORMACIÓN -->
    <div class="info-grid">
      <!-- DIRECCIÓN PRINCIPAL -->
      <div class="info-card">
        <div class="card-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
        </div>
        <h3>Dirección Principal</h3>
        <p class="address-main">{{ usuario.direccion }}</p>
        <p class="address-details">{{ usuario.ciudad }}, {{ usuario.departamento }}, {{ usuario.pais }}</p>
        <a href="#" class="card-link" (click)="editarDireccion()">
          Editar dirección
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </a>
      </div>

      <!-- MÉTODOS DE PAGO -->
      <div class="info-card">
        <div class="card-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
            <line x1="1" y1="10" x2="23" y2="10"></line>
          </svg>
        </div>
        <h3>Métodos de Pago</h3>
        <p class="payment-method">{{ usuario.metodoPago }}</p>
        <a href="#" class="card-link" (click)="administrarPagos()">
          Administrar pagos
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </a>
      </div>

      <!-- CUENTA Y SEGURIDAD -->
      <div class="info-card">
        <div class="card-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
        </div>
        <h3>Cuenta y Seguridad</h3>
        <p>Gestiona tu contraseña y configuración de seguridad</p>
        <a href="#" class="card-link" (click)="cambiarContrasena()">
          Cambiar contraseña
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="9 18 15 12 9 6"></polyline>
          </svg>
        </a>
      </div>
    </div>

    <!-- HISTORIAL DE PEDIDOS -->
    <div class="orders-section">
      <div class="section-header">
        <h2>Historial de Pedidos</h2>
        <span class="orders-badge">{{ usuario.pedidos.length }}</span>
      </div>

      <div class="orders-list" *ngIf="usuario.pedidos.length > 0; else noPedidos">
        <div class="order-item" *ngFor="let pedido of usuario.pedidos">
          <div class="order-header">
            <span class="order-id">Pedido #{{ pedido.id }}</span>
            <span class="order-status">Entregado</span>
          </div>
          <div class="order-details">
            <p>{{ pedido.articulos }} artículos</p>
            <p class="order-date">{{ pedido.fechaEntrega | date:'d MMM yyyy' }}</p>
          </div>
        </div>
      </div>

      <ng-template #noPedidos>
        <div class="empty-state">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          <p>Aún no tienes pedidos</p>
        </div>
      </ng-template>

      <a href="#" class="view-all-link">Ver todos los pedidos</a>
    </div>
  </div>
</div>

<!-- Template alternativo mientras se carga o si no hay datos -->
<ng-template #cargando>
  <div class="loading-container">
    <div class="spinner"></div>
    <p>Cargando tu perfil...</p>
  </div>
</ng-template>


